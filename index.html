<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trade Journal Pro - Ø¯ÙØªØ± ØªØ¯Ø§ÙˆÙ„</title>
    <style>
        * {margin:0;padding:0;box-sizing:border-box;}
        :root {
            --primary:#2196F3;--success:#4CAF50;--danger:#f44336;
            --warning:#ff9800;--light:#f5f5f5;--dark:#333;--text:#666;
        }
        body {font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:var(--light);color:var(--text);padding:20px;}
        .header {background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:30px;border-radius:8px;margin-bottom:30px;text-align:center;}
        .header h1 {font-size:2em;margin-bottom:10px;}
        .tabs {display:flex;gap:10px;margin-bottom:20px;flex-wrap:wrap;}
        .tab-btn {padding:10px 20px;border:none;background:white;border:2px solid #ddd;cursor:pointer;border-radius:5px;transition:all 0.3s;font-weight:600;}
        .tab-btn.active {background:var(--primary);color:white;border-color:var(--primary);}
        .tab-content {display:none;background:white;padding:30px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.1);}
        .tab-content.active {display:block;}
        .form-group {margin-bottom:15px;}
        .form-row {display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;}
        label {display:block;margin-bottom:5px;font-weight:600;font-size:0.9em;}
        input,select,textarea {width:100%;padding:10px;border:1px solid #ddd;border-radius:5px;font-size:1em;font-family:inherit;}
        input:focus,select:focus {outline:none;border-color:var(--primary);box-shadow:0 0 0 3px rgba(33,150,243,0.1);}
        .checkbox-grid {display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:10px;margin:15px 0;}
        .checkbox-item {display:flex;align-items:center;gap:8px;}
        input[type="checkbox"] {width:18px;height:18px;cursor:pointer;}
        .btn {padding:10px 20px;border:none;border-radius:5px;cursor:pointer;font-weight:600;transition:all 0.3s;}
        .btn-primary {background:var(--primary);color:white;}
        .btn-primary:hover {background:#1976D2;}
        .btn-danger {background:var(--danger);color:white;padding:5px 10px;font-size:0.9em;}
        .trades-table {width:100%;border-collapse:collapse;margin-top:20px;font-size:0.9em;}
        .trades-table th {background:var(--primary);color:white;padding:10px;text-align:right;}
        .trades-table td {padding:10px;border-bottom:1px solid #ddd;text-align:right;}
        .trades-table tr:hover {background:var(--light);}
        .stat-card {background:white;padding:20px;border-radius:8px;border-left:4px solid var(--primary);box-shadow:0 2px 5px rgba(0,0,0,0.05);margin-bottom:15px;}
        .stat-label {font-size:0.9em;color:#999;margin-bottom:5px;}
        .stat-value {font-size:1.8em;font-weight:bold;color:var(--primary);}
        .alert {padding:15px;border-radius:5px;margin-bottom:20px;border-left:4px solid #1565c0;}
        .alert-info {background:#e3f2fd;color:#1565c0;border-left-color:#1565c0;}
        @media(max-width:768px){.form-row{grid-template-columns:1fr;}.trades-table{font-size:0.8em;}}
    </style>
</head>
<body>
<div style="max-width:1200px;margin:0 auto;">
    <div class="header">
        <h1>ğŸ“Š Trade Journal Pro</h1>
        <p>ØªØ³Ø¬ÙŠÙ„ ÙˆØªØ­Ù„ÙŠÙ„ ØµÙÙ‚Ø§Øª Ø§Ù„Ø°Ù‡Ø¨ ÙˆØ§Ù„ÙØ¶Ø©</p>
    </div>

    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('new-trade', this)">ØµÙÙ‚Ø© Ø¬Ø¯ÙŠØ¯Ø© â•</button>
        <button class="tab-btn" onclick="switchTab('trades', this)">Ø§Ù„ØµÙÙ‚Ø§Øª ğŸ“‹</button>
        <button class="tab-btn" onclick="switchTab('stats', this)">Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ğŸ“ˆ</button>
    </div>

    <div id="new-trade" class="tab-content active">
        <div class="alert alert-info">ğŸ’¡ Ø³Ø¬Ù„ ÙƒÙ„ ØµÙÙ‚Ø© Ø¨Ø¯Ù‚Ø© - Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„ØµØ§Ø±Ù…Ø© Ù‡ÙŠ Ø·Ø±ÙŠÙ‚ Ø§Ù„ØªØ­Ø³Ù†</div>
        <form id="tradeForm">
            <div class="form-row">
                <div class="form-group">
                    <label>ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª</label>
                    <input type="datetime-local" id="dateTime" required>
                </div>
                <div class="form-group">
                    <label>ğŸ¥‡ Ø§Ù„Ø£Ø¯Ø§Ø©</label>
                    <select id="tool" required>
                        <option>-- Ø§Ø®ØªØ± Ø§Ù„Ø£Ø¯Ø§Ø© --</option>
                        <option>XAUUSD (Ø°Ù‡Ø¨)</option>
                        <option>XAGUSD (ÙØ¶Ø©)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ğŸ“ˆ Ø§Ù„Ù†ÙˆØ¹</label>
                    <select id="type" required>
                        <option>-- Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹ --</option>
                        <option>Ø´Ø±Ø§Ø¡ â¬†</option>
                        <option>Ø¨ÙŠØ¹ â¬‡</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>ğŸ’° Ø³Ø¹Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„</label>
                    <input type="number" id="entry" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>ğŸ¯ Ø§Ù„Ù‡Ø¯Ù (TP)</label>
                    <input type="number" id="target" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>ğŸ›‘ Ø§Ù„Ø³ØªÙˆØ¨ (SL)</label>
                    <input type="number" id="stop" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>ğŸ“Š Ø§Ù„Ù„ÙˆØª</label>
                    <input type="number" id="lot" step="0.01" required>
                </div>
            </div>

            <div class="form-group">
                <label>âœ… Ø´Ø±ÙˆØ· Ø§Ù„Ø¯Ø®ÙˆÙ„:</label>
                <div class="checkbox-grid">
                    <div class="checkbox-item"><input type="checkbox" id="c-struct" value="Ù‡ÙŠÙƒÙ„ÙŠØ©"><label for="c-struct">Ù‡ÙŠÙƒÙ„ÙŠØ©</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="c-ob" value="Ø£ÙˆØ±Ø¯Ø± Ø¨Ù„ÙˆÙƒ"><label for="c-ob">Ø£ÙˆØ±Ø¯Ø± Ø¨Ù„ÙˆÙƒ</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="c-rej" value="Ø±ÙØ¶ Ø³ÙŠÙˆÙ„Ø©"><label for="c-rej">Ø±ÙØ¶ Ø³ÙŠÙˆÙ„Ø©</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="c-rel" value="Ø±ÙŠÙ„ÙŠØªÙŠÙ"><label for="c-rel">Ø±ÙŠÙ„ÙŠØªÙŠÙ</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="c-fvg" value="FVG"><label for="c-fvg">FVG</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="c-sup" value="Ø¯Ø¹Ù…/Ù…Ù‚Ø§ÙˆÙ…Ø©"><label for="c-sup">Ø¯Ø¹Ù…/Ù…Ù‚Ø§ÙˆÙ…Ø©</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="c-f60" value="ÙÙŠØ¨Ùˆ 60"><label for="c-f60">ÙÙŠØ¨Ùˆ 60</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="c-ft" value="ÙÙŠØ¨Ùˆ Ø£Ù‡Ø¯Ø§Ù"><label for="c-ft">ÙÙŠØ¨Ùˆ Ø£Ù‡Ø¯Ø§Ù</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="c-ss" value="Ø³Ø­Ø¨ Ø¬Ù„Ø³Ø©"><label for="c-ss">Ø³Ø­Ø¨ Ø¬Ù„Ø³Ø©</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="c-sr" value="Ø±ÙØ¶ Ø¬Ù„Ø³Ø©"><label for="c-sr">Ø±ÙØ¶ Ø¬Ù„Ø³Ø©</label></div>
                </div>
            </div>

            <div class="form-group">
                <label>ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                <textarea id="notes" rows="3" placeholder="Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª..."></textarea>
            </div>

            <button type="submit" class="btn btn-primary">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØµÙÙ‚Ø©</button>
        </form>
    </div>

    <div id="trades" class="tab-content">
        <h2>ğŸ“‹ Ø§Ù„ØµÙÙ‚Ø§Øª Ø§Ù„Ù…Ø³Ø¬Ù„Ø©</h2>
        <div style="overflow-x:auto;">
            <table class="trades-table">
                <thead>
                    <tr>
                        <th>#</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø§Ù„Ø£Ø¯Ø§Ø©</th><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Ø§Ù„Ø¯Ø®ÙˆÙ„</th><th>Ø§Ù„Ù‡Ø¯Ù</th><th>Ø§Ù„Ø³ØªÙˆØ¨</th><th>Ø§Ù„Ø´Ø±ÙˆØ·</th><th>Ø­Ø°Ù</th>
                    </tr>
                </thead>
                <tbody id="tradesList">
                    <tr><td colspan="9" style="text-align:center;color:#999;">Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙÙ‚Ø§Øª</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <div id="stats" class="tab-content">
        <h2>ğŸ“ˆ Ø¥Ø­ØµØ§Ø¦ÙŠØ§ØªÙƒ</h2>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:15px;">
            <div class="stat-card"><div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµÙÙ‚Ø§Øª</div><div class="stat-value" id="total-trades">0</div></div>
            <div class="stat-card"><div class="stat-label">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø´Ø±ÙˆØ·</div><div class="stat-value" id="avg-conditions">0</div></div>
            <div class="stat-card"><div class="stat-label">ØµÙÙ‚Ø§Øª Ø§Ù„Ø°Ù‡Ø¨</div><div class="stat-value" id="gold-count">0</div></div>
            <div class="stat-card"><div class="stat-label">ØµÙÙ‚Ø§Øª Ø§Ù„ÙØ¶Ø©</div><div class="stat-value" id="silver-count">0</div></div>
        </div>
    </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDYp3EN5vAWDv2vhRqRZz2W4pJ8OVSU0bY",
  authDomain: "trade-cd45b.firebaseapp.com",
  projectId: "trade-cd45b",
  storageBucket: "trade-cd45b.firebasestorage.app",
  messagingSenderId: "591574352390",
  appId: "1:591574352390:web:d13245e5b8b86d71003987"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

let trades = [];

async function loadTrades() {
    const snapshot = await getDocs(collection(db, "trades"));
    trades = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
    renderTrades();
    updateStats();
}

async function saveTrade(trade) {
    const docRef = await addDoc(collection(db, "trades"), trade);
    trade.id = docRef.id;
    trades.push(trade);
    renderTrades();
    updateStats();
}

async function deleteTradeHandler(id) {
    if (confirm('Ø­Ø°Ù Ø§Ù„ØµÙÙ‚Ø©ØŸ')) {
        await deleteDoc(doc(db, "trades", id));
        trades = trades.filter(t => t.id !== id);
        renderTrades();
        updateStats();
    }
}

function updateStats() {
    document.getElementById('total-trades').textContent = trades.length;
    const avgCond = trades.length>0 ? (trades.reduce((s,t)=>s+(t.conditions?.length || 0),0)/trades.length).toFixed(1) : 0;
    document.getElementById('avg-conditions').textContent = avgCond;
    document.getElementById('gold-count').textContent = trades.filter(t=>t.tool.includes('XAUUSD')).length;
    document.getElementById('silver-count').textContent = trades.filter(t=>t.tool.includes('XAGUSD')).length;
}

function renderTrades() {
    const tbody=document.getElementById('tradesList');
    if(trades.length===0){tbody.innerHTML='<tr><td colspan="9" style="text-align:center;color:#999;">Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙÙ‚Ø§Øª</td></tr>';return;}
    tbody.innerHTML=trades.map((t,i)=>`
        <tr>
            <td>${i+1}</td>
            <td>${new Date(t.dateTime).toLocaleDateString('ar-IQ')}</td>
            <td>${t.tool}</td>
            <td>${t.type}</td>
            <td>${t.entry.toFixed(2)}</td>
            <td>${t.target.toFixed(2)}</td>
            <td>${t.stop.toFixed(2)}</td>
            <td>${(t.conditions?.length || 0)}/10</td>
            <td><button class="btn btn-danger" onclick="deleteTrade('${t.id}')">Ø­Ø°Ù</button></td>
        </tr>`).join('');
}

function switchTabHandler(tabName, btn) {
    document.querySelectorAll('.tab-content').forEach(t=>t.classList.remove('active'));
    document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
    document.getElementById(tabName).classList.add('active');
    btn.classList.add('active');
    if(tabName==='stats') updateStats();
}

document.getElementById('tradeForm').addEventListener('submit', async function(e){
    e.preventDefault();
    const conditions=Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(c=>c.value);
    const trade={
        dateTime:document.getElementById('dateTime').value,
        tool:document.getElementById('tool').value,
        type:document.getElementById('type').value,
        entry:parseFloat(document.getElementById('entry').value),
        target:parseFloat(document.getElementById('target').value),
        stop:parseFloat(document.getElementById('stop').value),
        lot:parseFloat(document.getElementById('lot').value),
        conditions:conditions,
        notes:document.getElementById('notes').value
    };
    await saveTrade(trade);
    alert('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„ØµÙÙ‚Ø©!');
    this.reset();
    document.getElementById('dateTime').valueAsDate=new Date();
});

window.addEventListener('load',()=>{document.getElementById('dateTime').valueAsDate=new Date();loadTrades();});

window.switchTab = switchTabHandler;
window.deleteTrade = deleteTradeHandler;
</script>
</body>
</html>